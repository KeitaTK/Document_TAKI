ワークスペース情報を収集していますArduPilotで外部から（例：Mission PlannerやMAVLink経由で）変更できるパラメータを追加する方法を、`AP_Observer`の実装例をもとにまとめます。

---

## ArduPilotで外部から変更可能なパラメータの追加方法

### 1. パラメータ変数のメンバとして追加

クラスのメンバ変数として、`AP_Float`や`AP_Int32`などの型で宣言します。

````cpp
// ...existing code...
AP_Float    _correction_gain;
AP_Float    _filter_cutoff_freq;
// ...existing code...
````

### 2. パラメータテーブル（var_info）の定義

`AP_Param::GroupInfo`の静的配列として、パラメータの情報を記述します。

````cpp
// ...existing code...
const AP_Param::GroupInfo AP_Observer::var_info[] = {
    // @Param: CORR_GAIN
    // @DisplayName: Observer Correction Gain
    // @Description: Gain for attitude correction based on external force estimation
    // @Range: 0.0 1.0
    // @User: Advanced
    AP_GROUPINFO("CORR_GAIN", 0, AP_Observer, _correction_gain, 0.004f),

    // @Param: FILT_CUTOFF
    // @DisplayName: Observer Filter Cutoff Frequency
    // @Description: Low-pass filter cutoff frequency [Hz]
    // @Range: 1.0 100.0
    // @User: Advanced
    AP_GROUPINFO("FILT_CUTOFF", 1, AP_Observer, _filter_cutoff_freq, 20.0f),

    AP_GROUPEND
};
// ...existing code...
````

### 3. setup_object_defaultsで初期化

クラスの初期化時に`AP_Param::setup_object_defaults(this, var_info);`を呼び出します。

````cpp
// ...existing code...
void AP_Observer::init(){
    AP_Param::setup_object_defaults(this, var_info);
    // ...その他の初期化処理...
}
// ...existing code...
````

### 4. パラメータ値の取得・利用

パラメータ値は`.get()`で取得できます。

````cpp
float correction_gain = _correction_gain.get();
float cutoff_freq = _filter_cutoff_freq.get();
````

### 5. Mission PlannerやMAVLinkからのアクセス

- パラメータ名は自動で接頭辞（例：OBS_）が付与されます（例：`OBS_CORR_GAIN`）。
- Mission PlannerやMAVLinkのPARAM_SET/PARAM_GETで値の取得・変更が可能です。

---

### 参考ファイル

- AP_Observer.h
- AP_Observer.cpp

---

この手順で追加したパラメータは、外部ツールから安全に読み書きできます。